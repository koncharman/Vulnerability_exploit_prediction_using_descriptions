#######Regression results
#Load fuzzy k-means model
tSparse_fclust=as.matrix(tSparse)%*%f_clust$U

row_sums_check=rowSums(tSparse)
row_sums_check[row_sums_check==0]=1
tSparse_fclust=tSparse_fclust/row_sums_check

categories_assignement=as.numeric(df_exploit[,2])

new2_trainSparse=cbind(tSparse_fclust,categories_assignement)
new2_trainSparse=as.data.frame(new2_trainSparse)

#### Oversample
library(smotefamily)
Adasyn=ADAS(new2_trainSparse[,-ncol(new2_trainSparse)],new2_trainSparse[,ncol(new2_trainSparse)],K=5)

new2_trainSparse=Adasyn$data


colnames(new2_trainSparse)[ncol(new2_trainSparse)]="Exploit_output"
new2_trainSparse$Exploit_output=as.numeric(new2_trainSparse$Exploit_output)

#####Binomial logistic regression
mylogit = glm(formula = Exploit_output ~., data = new2_trainSparse,family = binomial)#(link = "logit")
b=summary(mylogit)$coefficients
alias(mylogit)



#######Plot k-means model
#Select positions only from the top words
#Need to load f_clust (fuzzy k-means model)
pos=unique(match(ldaOut.terms,rownames(f_clust$Xca)))

colnames(f_clust$Xca)=c("x","y")

data_points= f_clust$Xca[pos,]
cluster_assign=f_clust$clus[pos,1]

###HULL Plot
library(concaveman)
library(ggforce)

library(ggrepel)
data_points=data.frame(f_clust$Xca[pos,],as.factor(f_clust$clus[pos,1]))
colnames(data_points)=c("x","y","Cluster")

plot_gg=ggplot( data = as.data.frame(data_points),mapping = aes(x, y,colour = Cluster,label = rownames(data_points))) +
  geom_mark_hull(aes(fill = Cluster,label=as.factor(Cluster)),concavity = 5) +
  geom_text_repel(max.overlaps = 50)+
  labs(colour="Cluster",x="x",y="y")+
  ggtitle("Cluster Plot")

ggsave("cluster_plot_new_repel.jpeg",width = 12,height = 10)
###

